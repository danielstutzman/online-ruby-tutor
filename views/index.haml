!!!html
%html
  %head
    / requirements for pytutor.js
    %script(src='/js/d3.v2.min.js')
    %script(src='/js/jquery-1.8.2.min.js')
    %script(src='/js/jquery.ba-bbq.min.js')
    %script(src='/js/jquery.jsPlumb-1.3.10-all-min.js')
    %script(src='/js/jquery-ui-1.8.24.custom.min.js')
    %script(src='/js/pytutor.js')
    %link(href='/css/pytutor.css' rel='stylesheet')

    / codemirror.net online code editor
    %script(src='/js/codemirror.js')
    %link(href='/css/codemirror.css' rel='stylesheet' type='text/css')
    %script(src='/js/codemirror-ruby.js')

    %script(src='/js/application.js')
    %link(href='/css/application.css' rel='stylesheet' type='text/css')
    %script
      - if @traces
        != "var traces_json = #{JSON.dump(@traces).inspect};"
      - if @word_to_method_indexes
        = "var word_to_method_indexes = {"
        - @word_to_method_indexes.each do |word, method_indexes|
          != "#{word.inspect}: #{method_indexes.inspect},"
        = "1: 1 };"
  %body
    #sidebar
      %a#edit-tab-link(href='#')
        #edit-tab.tab
          %h2 Edit
          %button Save
          %button Run
      .filler
      - @traces.each_with_index do |trace, i|
        %a.case-tab-link(href="#")
          .tab.case-tab{ :"data-case-num" => i }
            %h2
              = "Case #{i}"
      .filler.filler-tall

    #edit-content
      #user_code_div
        %textarea#user_code_textarea(name='user_code_textarea'
                                     cols='40' rows='10')
          = params["user_code_textarea"]
      != haml :ruby_composer

    - if @traces
      - @traces.each_with_index do |trace, i|
        .case-content{ :id => "trace_render_div#{i}" }
